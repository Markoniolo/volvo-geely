{"version":3,"sources":["scripts/form-validate.js"],"names":["forms","document","querySelectorAll","i","length","formInit","form","phone","querySelector","name","addEventListener","removeError","validate","maskPhone","IMask","mask","maskName","classList","remove","e","preventDefault","unmaskedValue","add","fetchForm","success","console","log","closeModalForm","openThanks","value","url","getAttribute","fetch","method","body","FormData","then","res","json","data","node","fancyboxContent","closest","closeBtn","click","thanksOpen","modalThanksButton"],"mappings":"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","sourcesContent":["const forms = document.querySelectorAll('[data-role=\"form-validate\"]')\n\nfor (let i = 0; i < forms.length; i++) {\n    formInit(forms[i])\n}\n\nfunction formInit (form) {\n    const phone = form.querySelector('[data-role=\"form-input-phone\"]')\n    const name = form.querySelector('[data-role=\"form-input-name\"]')\n\n    phone.addEventListener('input', removeError)\n    form.addEventListener('submit', validate)\n\n    const maskPhone = new IMask(phone, { mask: '+{7} (000) 000-00-00' });\n    const maskName = new IMask(name, { mask: /^[А-ЯЁa-zA-Z\\s]+$/i });\n\n    function removeError () {\n        this.classList.remove('input-error')\n    }\n\n    function validate (e) {\n        e.preventDefault()\n        if (maskPhone.unmaskedValue.length < 11) {\n            phone.classList.add('input-error')\n        } else {\n            fetchForm()\n        }\n    }\n\n    async function fetchForm () {\n        const url = form.getAttribute('action')\n        fetch(url, {\n            method: 'post',\n            body: new FormData(form),\n        })\n            .then(res => { return res.json() })\n            .then(data => { success() })\n            .catch(() => {\n                console.log('error')\n            })\n\n        success()\n\n        function success () {\n            console.log('success')\n            closeModalForm(form)\n            openThanks()\n            phone.value = ''\n            name.value = ''\n        }\n    }\n}\n\nfunction closeModalForm (node) {\n    const fancyboxContent = node.closest('.fancybox__content')\n    if (fancyboxContent) {\n        const closeBtn = fancyboxContent.querySelector('.is-close-btn')\n        closeBtn.click()\n    }\n}\n\nfunction openThanks () {\n    const thanksOpen = document.querySelector('[data-element=\"modal-thanks-open\"]')\n    thanksOpen.click()\n}\n\nconst modalThanksButton = document.querySelector('[data-element=\"modal-thanks-button\"]')\nmodalThanksButton.addEventListener('click', () => closeModalForm(modalThanksButton))\n"],"file":"form-validate.js"}